/usr/local/lib/python3.12/dist-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Map: 100%|██████████| 32207/32207 [00:00<?, ? examples/s]Map: 32229 examples [00:00, 156.89 examples/s]           Map: 32379 examples [00:00, 833.67 examples/s]Map: 32493 examples [00:00, 624.43 examples/s]Map: 32571 examples [00:00, 502.22 examples/s]Map: 32664 examples [00:00, 594.32 examples/s]Map: 32761 examples [00:01, 520.25 examples/s]Map: 32840 examples [00:01, 555.99 examples/s]Map: 33001 examples [00:01, 746.49 examples/s]Map: 33098 examples [00:01, 612.25 examples/s]Map: 33207 examples [00:01, 621.56 examples/s]Map: 33460 examples [00:01, 1005.20 examples/s]Map: 33633 examples [00:01, 1132.85 examples/s]Map: 33782 examples [00:02, 1083.14 examples/s]Map: 34004 examples [00:02, 1041.27 examples/s]Map: 34207 examples [00:02, 1226.97 examples/s]Map: 34367 examples [00:02, 639.04 examples/s] Map: 34501 examples [00:03, 716.58 examples/s]Map: 34646 examples [00:03, 827.79 examples/s]Map: 34833 examples [00:03, 929.72 examples/s]Map: 34988 examples [00:03, 1040.57 examples/s]Map: 35156 examples [00:03, 939.40 examples/s] Map: 35316 examples [00:03, 779.98 examples/s]Map: 35522 examples [00:04, 996.81 examples/s]Map: 35686 examples [00:04, 1121.14 examples/s]Map: 35909 examples [00:04, 1146.03 examples/s]Map: 36142 examples [00:04, 1385.95 examples/s]Map: 36345 examples [00:04, 1227.29 examples/s]Map: 36493 examples [00:04, 1262.83 examples/s]Map: 36649 examples [00:04, 1037.27 examples/s]Map: 36792 examples [00:05, 983.94 examples/s] Map: 36967 examples [00:05, 1082.05 examples/s]Map: 37104 examples [00:05, 822.80 examples/s] Map: 37348 examples [00:05, 1065.13 examples/s]Map: 37516 examples [00:05, 1173.66 examples/s]Map: 37754 examples [00:05, 1289.91 examples/s]Map: 37977 examples [00:06, 1491.39 examples/s]Map: 38207 examples [00:06, 1585.67 examples/s]Map: 38468 examples [00:06, 1617.97 examples/s]Map: 38643 examples [00:06, 1455.26 examples/s]Map: 38895 examples [00:06, 1044.33 examples/s]Map: 39063 examples [00:06, 1121.86 examples/s]Map: 39207 examples [00:07, 1005.92 examples/s]Map: 39479 examples [00:07, 1325.09 examples/s]Map: 39647 examples [00:07, 1339.76 examples/s]Map: 39879 examples [00:07, 1553.28 examples/s]Map: 40113 examples [00:07, 1740.08 examples/s]Map: 40402 examples [00:07, 1366.01 examples/s]Map: 40639 examples [00:07, 1561.18 examples/s]Map: 40909 examples [00:08, 1214.53 examples/s]Map: 41100 examples [00:08, 1331.86 examples/s]Map: 41308 examples [00:08, 1292.42 examples/s]Map: 41532 examples [00:08, 1476.82 examples/s]Map: 41764 examples [00:08, 1658.00 examples/s]Map: 42074 examples [00:08, 1746.99 examples/s]Map: 42279 examples [00:09, 1625.63 examples/s]Map: 42517 examples [00:09, 1793.08 examples/s]Map: 42777 examples [00:09, 1765.04 examples/s]Map: 43056 examples [00:09, 1792.39 examples/s]Map: 43316 examples [00:09, 1707.05 examples/s]Map: 43564 examples [00:09, 1876.93 examples/s]Map: 43887 examples [00:09, 1955.26 examples/s]Map: 44097 examples [00:10, 1778.71 examples/s]Map: 44310 examples [00:10, 1660.57 examples/s]Map: 44514 examples [00:10, 1742.14 examples/s]Map: 44737 examples [00:10, 1642.66 examples/s]Map: 44936 examples [00:10, 1539.98 examples/s]Map: 45095 examples [00:10, 1370.20 examples/s]Map: 45263 examples [00:10, 1164.68 examples/s]Map: 45420 examples [00:11, 1247.12 examples/s]Map: 45586 examples [00:11, 1183.90 examples/s]Map: 45803 examples [00:11, 1400.90 examples/s]Map: 46042 examples [00:11, 1444.50 examples/s]Map: 46207 examples [00:11, 1413.29 examples/s]Map: 46367 examples [00:11, 1451.46 examples/s]Map: 46566 examples [00:11, 1545.37 examples/s]Map: 46804 examples [00:11, 1752.73 examples/s]Map: 46996 examples [00:12, 1748.71 examples/s]Map: 47207 examples [00:12, 1806.41 examples/s]Map: 47481 examples [00:12, 2063.41 examples/s]Map: 47773 examples [00:12, 2238.14 examples/s]Map: 48049 examples [00:12, 2365.62 examples/s]Map: 48325 examples [00:12, 2322.14 examples/s]Map: 48612 examples [00:12, 2159.81 examples/s]Map: 48846 examples [00:12, 1741.31 examples/s]Map: 49088 examples [00:13, 1406.15 examples/s]Map: 49288 examples [00:13, 1321.13 examples/s]Map: 49464 examples [00:13, 1404.54 examples/s]Map: 49657 examples [00:13, 1515.28 examples/s]Map: 49833 examples [00:13, 1570.78 examples/s]Map: 50069 examples [00:13, 1538.15 examples/s]Map: 50335 examples [00:13, 1610.64 examples/s]Map: 50531 examples [00:14, 1690.80 examples/s]Map: 50729 examples [00:14, 1744.21 examples/s]Map: 51000 examples [00:14, 1990.90 examples/s]Map: 51253 examples [00:14, 2133.52 examples/s]Map: 51543 examples [00:14, 2346.59 examples/s]Map: 51788 examples [00:14, 2371.23 examples/s]Map: 52036 examples [00:14, 2397.95 examples/s]Map: 52365 examples [00:14, 2307.83 examples/s]Map: 52632 examples [00:15, 1877.05 examples/s]Map: 52892 examples [00:15, 1652.87 examples/s]Map: 53074 examples [00:15, 1522.14 examples/s]Map: 53354 examples [00:15, 1607.68 examples/s]Map: 53536 examples [00:15, 1647.20 examples/s]Map: 53794 examples [00:15, 1627.16 examples/s]Map: 53984 examples [00:15, 1683.54 examples/s]Map: 54207 examples [00:16, 1659.54 examples/s]Map: 54413 examples [00:16, 1749.79 examples/s]Map: 54615 examples [00:16, 1805.21 examples/s]Map: 54846 examples [00:16, 1936.52 examples/s]Map: 55077 examples [00:16, 1886.28 examples/s]Map: 55366 examples [00:16, 2125.68 examples/s]Map: 55605 examples [00:16, 2197.45 examples/s]Map: 55848 examples [00:16, 2221.86 examples/s]Map: 56112 examples [00:16, 2025.66 examples/s]Map: 56348 examples [00:17, 2092.27 examples/s]Map: 56645 examples [00:17, 2034.91 examples/s]Map: 56861 examples [00:17, 2062.26 examples/s]Map: 57097 examples [00:17, 1829.43 examples/s]Map: 57330 examples [00:17, 1831.20 examples/s]Map: 57571 examples [00:17, 1748.12 examples/s]Map: 57803 examples [00:17, 1658.05 examples/s]Map: 58011 examples [00:18, 1750.41 examples/s]Map: 58207 examples [00:18, 1692.62 examples/s]Map: 58426 examples [00:18, 1810.95 examples/s]Map: 58621 examples [00:18, 1842.31 examples/s]Map: 58858 examples [00:18, 1733.78 examples/s]Map: 59053 examples [00:18, 1783.49 examples/s]Map: 59279 examples [00:18, 1670.30 examples/s]Map: 59517 examples [00:18, 1843.42 examples/s]Map: 59732 examples [00:18, 1918.47 examples/s]Map: 59934 examples [00:19, 1942.49 examples/s]Map: 60207 examples [00:19, 1709.31 examples/s]Map: 60398 examples [00:19, 1749.63 examples/s]Map: 60657 examples [00:19, 1735.72 examples/s]Map: 60880 examples [00:19, 1314.72 examples/s]Map: 61047 examples [00:19, 1348.29 examples/s]Map: 61207 examples [00:19, 1381.21 examples/s]Map: 61396 examples [00:20, 1496.12 examples/s]Map: 61583 examples [00:20, 1583.00 examples/s]Map: 61779 examples [00:20, 1679.23 examples/s]Map: 61979 examples [00:20, 1721.83 examples/s]Map: 62162 examples [00:20, 1516.68 examples/s]Map: 62361 examples [00:20, 1364.32 examples/s]Map: 62514 examples [00:20, 1395.45 examples/s]Map: 62677 examples [00:21, 1253.14 examples/s]Map: 62926 examples [00:21, 1538.66 examples/s]Map: 63178 examples [00:21, 1768.19 examples/s]Map: 63378 examples [00:21, 1826.27 examples/s]Map: 63617 examples [00:21, 1959.88 examples/s]Map: 63966 examples [00:21, 2085.21 examples/s]Map: 64207 examples [00:21, 2118.42 examples/s]Map: 64414 examples [00:21, 1482.55 examples/s]
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
Traceback (most recent call last):
  File "/workspace/train_qlora.py", line 158, in <module>
    main()
  File "/workspace/train_qlora.py", line 149, in main
    trainer.train()
  File "/usr/local/lib/python3.12/dist-packages/transformers/trainer.py", line 2237, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/transformers/trainer.py", line 2487, in _inner_training_loop
    self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/transformers/trainer_callback.py", line 506, in on_train_begin
    return self.call_event("on_train_begin", args, state, control)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/transformers/trainer_callback.py", line 556, in call_event
    result = getattr(callback, event)(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/transformers/integrations/integration_utils.py", line 943, in on_train_begin
    self.setup(args, state, model, **kwargs)
  File "/usr/local/lib/python3.12/dist-packages/transformers/integrations/integration_utils.py", line 870, in setup
    self._wandb.init(
  File "/usr/local/lib/python3.12/dist-packages/wandb/sdk/wandb_init.py", line 1595, in init
    get_sentry().reraise(e)
  File "/usr/local/lib/python3.12/dist-packages/wandb/analytics/sentry.py", line 190, in reraise
    raise exc.with_traceback(tb)
  File "/usr/local/lib/python3.12/dist-packages/wandb/sdk/wandb_init.py", line 1516, in init
    wi.maybe_login(init_settings)
  File "/usr/local/lib/python3.12/dist-packages/wandb/sdk/wandb_init.py", line 193, in maybe_login
    wandb_login._login(
  File "/usr/local/lib/python3.12/dist-packages/wandb/sdk/wandb_login.py", line 190, in _login
    auth = _find_or_prompt_for_key(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/wandb/sdk/wandb_login.py", line 266, in _find_or_prompt_for_key
    auth = wbauth.authenticate_session(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/wandb/sdk/lib/wbauth/authenticate.py", line 139, in authenticate_session
    raise UsageError(
wandb.errors.errors.UsageError: No API key configured. Use `wandb login` to log in.
